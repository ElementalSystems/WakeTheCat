<!DOCTYPE html>
<html>

<head>
    <title>WindChime Demo</title>
</head>

<body>
    Short O3
    <button onclick="playGong(0,3)">Play C Gong</button>
    <button onclick="playGong(2,3)">Play D Gong</button>
    <button onclick="playGong(4,3)">Play E Gong</button>
    <button onclick="playGong(7,3)">Play G Gong</button>
    <button onclick="playGong(9,3)">Play A Gong</button>
    <hr />
    Short O4
    <button onclick="playGong(0,4)">Play C Gong</button>
    <button onclick="playGong(2,4)">Play D Gong</button>
    <button onclick="playGong(4,4)">Play E Gong</button>
    <button onclick="playGong(7,4)">Play G Gong</button>
    <button onclick="playGong(9,4)">Play A Gong</button>
    <hr />
    long O3
    <button onclick="playGong(0,3,20)">Play C Gong</button>
    <button onclick="playGong(2,3,20)">Play D Gong</button>
    <button onclick="playGong(4,3,20)">Play E Gong</button>
    <button onclick="playGong(7,3,20)">Play G Gong</button>
    <button onclick="playGong(9,3,20)">Play A Gong</button>
    <hr />
    Long O4
    <button onclick="playGong(0,4,20)">Play C Gong</button>
    <button onclick="playGong(2,4,20)">Play D Gong</button>
    <button onclick="playGong(4,4,20)">Play E Gong</button>
    <button onclick="playGong(7,4,20)">Play G Gong</button>
    <button onclick="playGong(9,4,20)">Play A Gong</button>
    <hr />



    <script>
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        // Convert note name (like "C4", "F#3") to frequency in Hz
        //SemiTone Codes
        // C  = 0
        // C# = 1
        // D  = 2
        // D# = 3
        // E  = 4
        // F  = 5
        // F# = 6
        // G  = 7
        // G# = 8
        // A  = 9
        // A# = 10
        // B  = 11
        // Chime sound generator
        function playGong(STC, oct, dur = 10, v = 1) {
            const baseFreq = 440 * Math.pow(2, ((oct + 1) * 12 + STC - 69) / 12);;
            const now = audioCtx.currentTime;

            const master = audioCtx.createGain();
            master.gain.setValueAtTime(0.2 * v, now);
            master.gain.exponentialRampToValueAtTime(0.0001, now + dur);
            master.connect(audioCtx.destination);

            // Fundamental
            makeTone(baseFreq, master, now, dur);

            // Gong-like inharmonic partials
            makeTone(baseFreq * 2.01, master, now, dur * 0.9);
            makeTone(baseFreq * 2.62, master, now, dur * 0.7);
            makeTone(baseFreq * 3.95, master, now, dur * 0.5);
        }

        // Helper: tone with exponential decay
        function makeTone(freq, destination, startTime, duration) {
            const osc = audioCtx.createOscillator();
            osc.type = "sine";
            osc.frequency.setValueAtTime(freq, startTime);

            const gain = audioCtx.createGain();
            gain.gain.setValueAtTime(1, startTime);
            gain.gain.exponentialRampToValueAtTime(0.0001, startTime + duration);

            osc.connect(gain).connect(destination);
            osc.start(startTime);
            osc.stop(startTime + duration);
        }
    </script>
</body>

</html>